<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Telegram Login</title>
<script>
let logInterval;

async function runLogin() {
    const fileInput = document.getElementById("session_file");
    const formData = new FormData();
    formData.append("session_file", fileInput.files[0]);

    const res = await fetch("/upload_run", { method: "POST", body: formData });
    const data = await res.json();
    alert(data.message);

    // Start polling logs
    if (logInterval) clearInterval(logInterval);
    logInterval = setInterval(async () => {
        const res = await fetch("/logs");
        const data = await res.json();
        document.getElementById("log_table").innerHTML =
            `<tr><td>${data.logs.replace(/\n/g, "<br>")}</td></tr>`;
    }, 2000);
}
</script>
</head>
<body>
<h2>Telegram Session Login</h2>

<input type="file" id="session_file" accept=".session">
<button onclick="runLogin()">Run</button>

<h3>Output Logs</h3>
<table border="1" id="log_table">
<tr><td></td></tr>
</table>
</body>
</html>
